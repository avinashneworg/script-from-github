aws ec2 start-instances --instance-ids i-0d296cb8593b80f22 --region ap-south-1
aws ec2 start-instances --instance-ids i-09ebf5fa374b2b916 --region ap-south-1
aws ec2 start-instances --instance-ids i-082e402accae364a1 --region ap-south-1
aws ec2 start-instances --instance-ids i-02f98f0a49651045a --region ap-south-1
aws ec2 start-instances --instance-ids i-09a0abda61c65127a --region ap-south-1
aws ec2 start-instances --instance-ids i-0a9875889df8d1a4b --region ap-south-1
aws ec2 start-instances --instance-ids i-08ea96294bdfdb8d2 --region ap-south-1
aws ec2 start-instances --instance-ids i-0d34f1fad28f156a1 --region ap-south-1




#!/bin/bash
INSTANCE_demo_ca_prod_dsd_server_ID=i-09ebf5fa374b2b916
INSTANCE_demo_ca_prod_dsd_server_v2_ID=i-0d296cb8593b80f22
INSTANCE_demo_PII_ID=i-082e402accae364a1
INSTANCE_dc_api_demo_ID=i-02f98f0a49651045a
INSTANCE_demo_lrd_v3_ID=i-09a0abda61c65127a
INSTANCE_demo_lab_instance_ID=i-0a9875889df8d1a4b
INSTANCE_demo_dc_models_ID=i-08ea96294bdfdb8d2
INSTANCE_ihx_demo_bill_extractor_ID=i-0d34f1fad28f156a1



sleep 30
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_ca_prod_dsd_server_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_demo_ca_prod_dsd_server"
echo " $INSTANCE_STATE"

sleep 2
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_ca_prod_dsd_server_v2_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_demo_ca_prod_dsd_server_v2"
echo " $INSTANCE_STATE"

sleep 2
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_PII_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_demo_PII"
echo " $INSTANCE_STATE"

sleep 2
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_dc_api_demo_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_dc_api_demo"
echo " $INSTANCE_STATE"

sleep 2
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_lrd_v3_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_demo_lrd_v3"
echo " $INSTANCE_STATE"

sleep 2
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_lab_instance_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_demo_lab_instance"
echo " $INSTANCE_STATE"

sleep 2
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_dc_models_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_demo_dc_models"
echo " $INSTANCE_STATE"

sleep 2
INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_ihx_demo_bill_extractor_ID --output text --query 'Reservations[].Instances[].State.Name');
echo "INSTANCE_ihx_demo_bill_extractor"
echo " $INSTANCE_STATE"





















pipeline {
    agent any
    stages {
        stage('Check DSD Server Instance Status') {
            steps {
                sh '''

                INSTANCE_demo_ca_prod_dsd_server_ID=i-09ebf5fa374b2b916
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_ca_prod_dsd_server_ID --output text --query 'Reservations[].Instances[].State.Name');

                echo "INSTANCE_demo_ca_prod_dsd_server : $INSTANCE_demo_ca_prod_dsd_server_ID : $INSTANCE_STATE"

                '''
            }
        }
        stage('Check DSD V2 Server Instance Status') {
            steps {
                sh '''

                INSTANCE_demo_ca_prod_dsd_server_v2_ID=i-0d296cb8593b80f22
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_ca_prod_dsd_server_v2_ID --output text --query 'Reservations[].Instances[].State.Name');
                echo "INSTANCE_demo_ca_prod_dsd_server_v2 : $INSTANCE_demo_ca_prod_dsd_server_v2_ID : $INSTANCE_STATE"

                '''
            }
        }
        stage('Check PII Server Instance Status') {
            steps {
                sh '''

                INSTANCE_demo_PII_ID=i-082e402accae364a1
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_PII_ID --output text --query 'Reservations[].Instances[].State.Name');
                echo "INSTANCE_demo_PII : $INSTANCE_demo_PII_ID : $INSTANCE_STATE"

                '''
            }
        }
        stage('Check LRD Server Instance Status') {
            steps {
                sh '''

                INSTANCE_demo_lrd_v3_ID=i-09a0abda61c65127a
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_lrd_v3_ID --output text --query 'Reservations[].Instances[].State.Name');
                echo "INSTANCE_demo_lrd_v3 : $INSTANCE_demo_lrd_v3_ID : $INSTANCE_STATE"

                '''
            }
        }
        stage('Check LAB Instance Status') {
            steps {
                sh '''

                INSTANCE_demo_lab_instance_ID=i-0a9875889df8d1a4b
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_lab_instance_ID --output text --query 'Reservations[].Instances[].State.Name');
                echo "INSTANCE_demo_lab_instance : $INSTANCE_demo_lab_instance_ID : $INSTANCE_STATE"

                '''
            }
        }
        stage('Check DC API Server Instance Status') {
            steps {
                sh '''

                INSTANCE_dc_api_demo_ID=i-02f98f0a49651045a
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_dc_api_demo_ID --output text --query 'Reservations[].Instances[].State.Name');
                echo "INSTANCE_dc_api_demo : $INSTANCE_dc_api_demo_ID : $INSTANCE_STATE"

                '''
            }
        }
        stage('Check DC MODEL Instance Status') {
            steps {
                sh '''

                INSTANCE_demo_dc_models_ID=i-08ea96294bdfdb8d2
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_demo_dc_models_ID --output text --query 'Reservations[].Instances[].State.Name');
                echo "INSTANCE_demo_dc_models : $INSTANCE_demo_dc_models_ID : $INSTANCE_STATE"

                '''
            }
        }
        stage('Check BILL EXTRACTOR Instance Status') {
            steps {
                sh '''

                INSTANCE_ihx_demo_bill_extractor_ID=i-0d34f1fad28f156a1
                INSTANCE_STATE=$(aws ec2 describe-instances --instance-ids $INSTANCE_ihx_demo_bill_extractor_ID --output text --query 'Reservations[].Instances[].State.Name');
                echo "INSTANCE_ihx_demo_bill_extractor : $INSTANCE_ihx_demo_bill_extractor_ID : $INSTANCE_STATE"

                '''
            }
        } // End Stage
    } // End Stages
    
    post {
        always {
            notifyStatus()
        }
    }
}

def notifyStatus() {
    // send to email
    emailext body: 'Instance Status Check in the Demo Environment', recipientProviders: [[$class: 'DevelopersRecipientProvider'], [$class: 'RequesterRecipientProvider']], subject: 'Demo Environment Status', to: 'vivek.venkatachalam@ihx.in'
}














